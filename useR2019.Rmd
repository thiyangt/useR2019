---
title: Feature-based Time Series Forecasting
author: Thiyanga Talagala, \break Rob J Hyndman, George Athanasopoulos \break Feng Li, Yanfei Kang
date:  "11 June 2019"
fontsize: 12pt
classoption: compress
toc: false
output:
  binb::monash:
    fig_height: 5
    fig_width: 8
    highlight: tango
    incremental: no
    keep_tex: no
    includes:
      in_header: preamble.tex
---


```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, cache=TRUE, dev.args=list(bg=grey(0.9), pointsize=11))
library(ggplot2)
library(patchwork)
library(reshape2)
library(grid)
library(gridExtra)
library(ggrepel)
library(png)
library(tsfeatures)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
library(dplyr)
library(forecast)
library(tidyr)
library(rlang)
library(tidyverse)
library(Mcomp)
```



## Big picture

\begin{tikzpicture}
    \node<1> (img1) {\centerline{\includegraphics[width=\paperwidth, height=6.3cm]{img/rice1.png}}};
    \node<2> (img2) {\centerline{\includegraphics[width=\paperwidth, height=6.3cm]{img/rice2.png}}};
\end{tikzpicture}

\begin{itemize}[<+->]
\vfill\item What algorithm is likely to perform best?
\vfill\item Algorithm selection problem, John Rice (1976)
\end{itemize}


## Time series features

\fontsize{13}{14}\sf

* Transform a given time series $y=\{y_1, y_2, \cdots, y_n\}$ to a feature vector $F = (f_1(y), f_2(y), \cdots, f_p(y))'$}.

\pause

\begincols
\begincol{.48\textwidth}


```{r, warning=FALSE, message=F, echo=FALSE, fig.height=10}
library(Mcomp)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggrepel)
library(png)
library(tsfeatures)
library(tidyverse)
library(ggpubr)

# Extract required series
series_id <- c("N0001", "N0633", "N0625", "N0645","N1912", "N2012")
six_series <- lapply(M3[series_id], function(u){u$x})
p <- lapply(six_series,
function(u) {autoplot(u) + xlab("") + ylab("")}
)
for (i in seq_along(six_series))
p[[i]] <- p[[i]] + ggtitle(series_id[i])+theme(title =element_text(size=30, face='bold'))
grid.arrange(grobs = p, ncol = 2)

```

\endcol 
\begincol{.48\textwidth}

\pause

```{r fig2, fig.height=6.8, fig.width=7, message=F, echo=F, warning=F}
df <- tsfeatures(six_series, c("stl_features")) %>%
  select(trend, seasonal_strength) %>%
  rename(seasonality = seasonal_strength) %>%
  replace_na(list(seasonality = 0))
df$id <- names(six_series)
ggplot(df, aes(x = trend, y = seasonality)) +
  geom_point(size = 5, color = 'red') +
  xlim(0, 1) + ylim(0, 1) +
  coord_fixed() +
  geom_text_repel(
    aes(label = id),
    colour = "black",
    size = 10,
    box.padding = unit(0.5, "lines")
  ) +
  theme(legend.position = "none", text = element_text(size=20))
```

  \endcol
\endcols



